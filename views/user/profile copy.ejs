<%- include('../include/head.ejs') %>
</head>

<body>
    <%- include('../include/navigation.ejs') %>

    <main class="profile-main">
        <div class="profile-container">
            <div class="profile-header">
                <img src="<%= user.profilePic %>" alt="Profile Picture" class="profile-pic">
                <h1 class="username"><%= user.username %></h1>
                <p class="email"><%= user.email %></p>
            </div>

            <div class="profile-info">
                <h2>Personal Information</h2>
                <p><strong>Name:</strong> <%= user.name %></p>
                <p><strong>Email:</strong> <%= user.email %></p>
                <p><strong>Verified:</strong> <%= user.verified ? 'Yes' : 'No' %></p>
                <p><strong>User Type:</strong> <%= user.userType %></p>
            </div>

            <div class="rental-cart">
                <h2>Rental Cart</h2>
                <% if (user.rentalCart.items.length > 0) { %>
                    <ul>
                        <% user.rentalCart.items.forEach(item => { %>
                            <li>
                                <p><strong>Product ID:</strong> <%= item.productId.name %></p>
                                <p><strong>Quantity:</strong> <%= item.quantity %></p>
                                <p><strong>Start Date:</strong> <%= item.StartDate.toLocaleDateString() %></p>
                                <p><strong>End Date:</strong> <%= item.EndDate.toLocaleDateString() %></p>
                            </li>
                        <% }) %>
                    </ul>
                <% } else { %>
                    <p>No items in rental cart.</p>
                <% } %>
            </div>

            <div class="wishlist">
                <h2>Wishlist</h2>
                <% if (user.wishlist.length > 0) { %>
                    <ul>
                        <% user.wishlist.forEach(product => { %>
                            <li><%= product.name %></li>
                        <% }) %>
                    </ul>
                <% } else { %>
                    <p>No items in wishlist.</p>
                <% } %>
            </div>

            <div class="rentals">
                <h2>Past Rentals</h2>
                <% if (user.rentals.length > 0) { %>
                    <ul>
                        <% user.rentals.forEach(rental => { %>
                            <li>
                                <p><strong>Rental ID:</strong> <%= rental._id %></p>
                                <p><strong>Product Names:</strong>
                                    <% rental.productId.forEach(product => { %>
                                        <%= product.name %>, 
                                    <% }) %>
                                </p>
                                <p><strong>Rental Start Date:</strong> <%= rental.rentalStartDate.toLocaleDateString() %></p>
                                <p><strong>Rental End Date:</strong> <%= rental.rentalEndDate.toLocaleDateString() %></p>
                                <p><strong>Status:</strong> <%= rental.status %></p>
                                <p><strong>Cost:</strong> $<%= rental.rentalCost %></p>
                                <p><strong>Payment Status:</strong> <%= rental.paymentStatus %></p>
                            </li>
                        <% }) %>
                    </ul>
                <% } else { %>
                    <p>No past rentals.</p>
                <% } %>
            </div>

            <div class="orders">
                <h2>Order History</h2>
                <% if (orders.length > 0) { %>
                    <ul>
                        <% orders.forEach(order => { %>
                            <li>
                                <p><strong>Order ID:</strong> <%= order._id ||null %></p>
                                <p><strong>Product Names:</strong>
                                    <% order.products.forEach(item => { %>
                                        <%= item.product.name %> (x<%= item.quantity %>), 
                                    <% }) %>
                                </p>
                                <p><strong>Total Price:</strong> $<%= order.totalPrice %></p>
                                <p><strong>Shipping Address:</strong> <%= order.shippingAddress %></p>
                                <p><strong>Status:</strong> <%= order.status %></p>
                                <p><strong>Payment Status:</strong> <%= order.paymentStatus %></p>
                                <p><strong>Order Date:</strong> <%= order.orderDate.toLocaleDateString() %></p>
                            </li>
                        <% }) %>
                    </ul>
                <% } else { %>
                    <p>No orders found.</p>
                <% } %>
            </div>
        </div>
    </main>

    <%- include('../include/footer.ejs') %>


    <style>
        .profile-main {
    display: flex;
    justify-content: center;
    padding: 20px;
}

.profile-container {
    max-width: 800px;
    width: 100%;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.profile-header {
    text-align: center;
    margin-bottom: 20px;
}

.profile-pic {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    margin-bottom: 10px;
}

.username {
    margin: 0;
    font-size: 24px;
    font-weight: bold;
}

.email {
    margin: 0;
    color: #777;
}

.profile-info, .rental-cart, .wishlist, .rentals, .orders {
    margin-bottom: 20px;
}

h2 {
    border-bottom: 2px solid #f0f0f0;
    padding-bottom: 5px;
    margin-bottom: 10px;
}

ul {
    list-style-type: none;
    padding: 0;
}

li {
    background: #f9f9f9;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-bottom: 5px;
}

li p {
    margin: 0;
}

    </style>
</body>
</html>
